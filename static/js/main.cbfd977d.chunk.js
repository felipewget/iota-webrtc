(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1012:function(e,t,n){"use strict";n.r(t);n(55),n(59),n(60),n(61),n(62),n(63),n(64),n(65),n(66),n(67),n(68),n(69),n(70),n(71),n(72),n(73),n(74),n(75),n(76),n(77),n(78),n(79),n(80),n(81),n(82),n(83),n(84),n(42),n(85),n(86),n(87),n(88),n(89),n(90),n(91),n(92),n(93),n(94),n(95),n(96),n(97),n(98),n(99),n(100),n(101),n(102),n(103),n(104),n(105),n(106),n(107),n(108),n(109),n(46),n(110),n(111),n(112),n(113),n(114),n(115),n(116),n(117),n(118),n(119),n(120),n(121),n(122),n(123),n(124),n(125),n(126),n(127),n(128),n(129),n(130),n(131),n(132),n(133),n(134),n(135),n(136),n(137),n(138),n(139),n(140),n(141),n(142),n(143),n(144),n(145),n(146),n(147),n(148),n(149),n(150),n(151),n(152),n(153),n(154),n(155),n(156),n(157),n(158),n(159),n(160),n(161),n(162),n(163),n(164),n(165),n(166),n(167),n(168),n(169),n(170),n(171),n(172),n(173),n(174),n(175),n(176),n(177),n(178),n(179),n(180),n(181),n(182),n(183),n(184),n(49),n(185),n(186),n(187),n(188),n(50),n(189),n(190),n(191),n(192),n(193),n(194),n(195),n(196),n(197),n(198),n(199),n(200),n(201),n(202),n(203),n(204),n(205),n(206),n(207),n(208),n(209),n(210),n(211),n(212),n(213),n(214),n(215),n(216),n(217),n(218),n(219),n(220),n(221),n(222),n(223),n(224),n(225),n(226),n(227),n(228),n(229),n(230),n(231),n(232),n(233),n(234),n(235),n(236),n(237),n(238),n(239),n(240),n(241),n(242),n(243),n(244),n(245),n(246),n(247),n(47),n(248),n(249),n(250),n(251),n(252),n(253),n(254),n(51);var a=n(365),r=n(3),o=n.n(r),c=n(27),i=n.n(c),s=(n(719),n(1057)),l=(n(572),n(431)),u=n(660),d=n(379),m=n(11),b=n(1053),p=n(1054),f=n(1055),g=n(1056),v=n(474),O=n.n(v),h=n(682),j=n(1014),E=n(34),y=n.n(E),w=n(346),S=n(407),k=n.n(S),C=n(661),A=n.n(C),x=n(522),I=n.n(x),T=n(662),N=n(519),D=/[^A-Z9]+/g,M=81,G=27,L=4,R=3e3,P={SPAM_NET:{URL:"https://nodes.spamnet.iota.org:443",MWM:7},DEV_NET1:{URL:"https://nodes.devnet.iota.org:443",MWM:9},DEV_NET2:{URL:"https://nodes.devnet.thetangle.org:443",MWM:9}},U="/",B="/signup",W="/login",_="/chatroom/:roomId",H="/chatgui",V="#33B3A6";function J(e){var t="";if(!(window&&window.crypto&&window.crypto.getRandomValues))return console.error("No native crypto random available");for(;t.length<e;)t+=A.a.encode(window.crypto.getRandomValues(new Uint32Array(e))).replace(D,"");return t.substring(0,e)}var F=function(){return Math.floor((new Date).getTime()/1e3)},q=function(e,t){return k.a.SHA1(e+t).toString()},Q=function(){var e=Object(w.a)(y.a.mark(function e(t){return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(navigator&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)){e.next=2;break}return e.abrupt("return",navigator.mediaDevices.getUserMedia(t));case 2:return e.abrupt("return",new Error("User Media Not Supported!"));case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),z=function(e){var t,n=function(e){var t;try{t=JSON.parse(Object(T.extractJson)(e))}catch(n){console.log(n),console.log(e)}return t}(e);return JSON.parse((t=n,I.a.decompress(t,{inputEncoding:"Base64"})))},Z=function(e,t){var n=function(e){return I.a.compress(e,{outputEncoding:"Base64"})}(JSON.stringify(e)),a=Object(N.asciiToTrytes)(JSON.stringify(n));return[{address:J(M),tag:t,value:0,message:a}]},K=n(0),X=n.n(K),Y=n(664),$=n.n(Y),ee=n(663),te=n.n(ee),ne=n(1048),ae=n(1049),re=n(1058),oe=function(e){var t=e.setShowPassword,n=e.password,a=e.setPassword,r=e.showPassword;return X.a.createElement(re.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:r?"text":"password",id:"password",value:n,onChange:function(e){return a(e.target.value)},InputProps:{endAdornment:X.a.createElement(ne.a,{position:"end"},X.a.createElement(ae.a,{edge:"end","aria-label":"toggle password visibility",onClick:function(){return t(function(e){return!e})}},r?X.a.createElement(te.a,null):X.a.createElement($.a,null)))}})},ce=function(e){var t=e.setValue,n=e.value,a=e.label;return X.a.createElement(re.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,label:a,type:"text",id:a.toLowerCase(),value:n,onChange:function(e){return t(e.target.value)}})},ie=n(679),se=n(7),le=n(665),ue=n.n(le),de=n(667),me=n.n(de),be=n(668),pe=n.n(be),fe=n(669),ge=n.n(fe),ve=n(1050),Oe=n(1051),he=n(1060),je=n(1052),Ee=n(666),ye=n.n(Ee),we={success:ue.a,warning:ye.a,error:me.a,info:pe.a},Se=Object(j.a)(function(e){return{success:{backgroundColor:ve.a[600]},error:{backgroundColor:e.palette.error.dark},info:{backgroundColor:e.palette.primary.main},warning:{backgroundColor:Oe.a[700]},icon:{fontSize:20},iconVariant:{opacity:.9,marginRight:e.spacing(1)},message:{display:"flex",alignItems:"center"}}});function ke(e){var t=Se(),n=e.className,a=e.message,r=e.onClose,o=e.variant,c=Object(ie.a)(e,["className","message","onClose","variant"]),i=we[o];return X.a.createElement(je.a,Object.assign({className:Object(se.a)(t[o],n),"aria-describedby":"client-snackbar",message:X.a.createElement("span",{id:"client-snackbar",className:t.message},X.a.createElement(i,{className:Object(se.a)(t.icon,t.iconVariant)}),a),action:[X.a.createElement(ae.a,{key:"close","aria-label":"close",color:"inherit",onClick:r},X.a.createElement(ge.a,{className:t.icon}))]},c))}var Ce=Object(j.a)(function(e){return{margin:{margin:e.spacing(1)}}});function Ae(e){var t=e.variant,n=e.message,a=e.open,r=e.onClose,o=e.autoHideDuration;Ce();return X.a.createElement("div",null,X.a.createElement(he.a,{anchorOrigin:{vertical:"top",horizontal:"right"},open:a,autoHideDuration:o,onClose:r},X.a.createElement(ke,{onClose:function(e,t){"clickaway"!==t&&r()},variant:t,message:n})))}var xe={username:"",userHash:"",loggedIn:!1,seed:null,myId:null,tangleNet:P.DEV_NET1,iceServers:[{urls:"stun:global.stun.twilio.com:3478?transport=udp"},{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun2.l.google.com:19302"},{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun.vodafone.ro:3478"},{urls:"stun:stun.xs4all.nl:3478"}],accountData:null,monitoringInterval:3e3,myAccount:null,provider:P.DEV_NET1.URL,myBalance:0},Ie=X.a.createContext(),Te=Object(j.a)(function(e){return{"@global":{body:{backgroundColor:e.palette.common.white}},paper:{marginTop:e.spacing(4),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:V},form:{width:"100%",marginTop:e.spacing(3)},submit:{margin:e.spacing(3,0,2),backgroundColor:V}}});function Ne(e){var t,n=e.history,a=Object(r.useContext)(Ie),c=Object(r.useGlobal)("seed"),i=Object(m.a)(c,2)[1],s=Object(r.useGlobal)("loggedIn"),l=Object(m.a)(s,2)[1],u=Object(r.useGlobal)("username"),d=Object(m.a)(u,2)[1],v=Object(r.useGlobal)("myId"),j=Object(m.a)(v,2)[1],E=Object(r.useState)("info"),y=Object(m.a)(E,2),w=y[0],S=y[1],k=Object(r.useState)("Info"),C=Object(m.a)(k,2),A=C[0],x=C[1],I=Object(r.useState)(!1),T=Object(m.a)(I,2),N=T[0],D=T[1];var M=Object(r.useState)(""),G=Object(m.a)(M,2),L=G[0],R=G[1],P=Object(r.useState)(""),U=Object(m.a)(P,2),B=U[0],W=U[1],_=Object(r.useState)(""),H=Object(m.a)(_,2),V=H[0],J=H[1],F=Object(r.useState)(!1),Q=Object(m.a)(F,2),z=Q[0],Z=Q[1],K=Object(r.useState)(!1),X=Object(m.a)(K,2),Y=X[0],$=X[1];a&&(t=function(){var e,t=a.getCollection("users"),n=null,o="";if(Y?n=t.findOne({seed:L}):(o=q(V,B),n=t.findOne({userHash:o})),!n)return e="error",x("User not found"),S(e),void D(!0);var c=JSON.stringify(n);return localStorage.setItem("userData",c),i(n.seed),j(n.myId),d(n.username),l(!0),console.log(Object(r.getGlobal)())});var ee=Te();return o.a.createElement(b.a,{component:"main",maxWidth:"sm"},o.a.createElement("div",{className:ee.paper},o.a.createElement(p.a,{className:ee.avatar},o.a.createElement(O.a,null)),o.a.createElement(h.a,{component:"h1",variant:"h5"},"Login with ".concat(Y?"seed":"username/password")),o.a.createElement("form",{className:ee.form},Y?o.a.createElement(ce,{label:"Seed",value:L,setValue:R}):o.a.createElement(o.a.Fragment,null,o.a.createElement(ce,{label:"Username",value:V,setValue:J}),o.a.createElement(oe,{setShowPassword:Z,password:B,setPassword:W,showPassword:z})),o.a.createElement(f.a,{type:"button",fullWidth:!0,variant:"contained",color:"primary",className:ee.submit,onClick:t},"Login"),o.a.createElement(g.a,{container:!0},o.a.createElement(g.a,{item:!0,xs:!0},o.a.createElement(f.a,{type:"button",onClick:function(){$(function(e){return!e})}},Y?"Login with name/password":"Login with seed")),o.a.createElement(g.a,{item:!0},o.a.createElement(f.a,{type:"button",onClick:function(){n.push("/signup")}},"Create an account"))))),o.a.createElement(Ae,{variant:w,message:A,open:N,onClose:function(){return D(!1)},autoHideDuration:2e3}))}var De=n(525),Me=n(475),Ge=n(433),Le=n(378),Re=n(670),Pe=n(671),Ue=n(680),Be=n(672),We=n(435),_e=n(681),He=n(363),Ve=n.n(He),Je=n(673),Fe=n.n(Je),qe=n(476),Qe=n.n(qe),ze=n(30),Ze=n(432),Ke=function(e){function t(e){var n,r=e.seed,o=e.username,c=(e.myId,e.roomId),i=e.minWeight,s=e.iceServers,l=e.interval,u=e.provider,d=e.account;return Object(Re.a)(this,t),(n=Object(Ue.a)(this,Object(Be.a)(t).call(this))).type={WEBRTCSIGNAL:"WEBRTCSIGNAL",REQUEST:"REQUEST",DONATE_OFFER:"DONATE_OFFER",DONATE_ACCEPT:"DONATE_ACCEPT",CHAT_MESSAGE:"CHAT_MESSAGE"},n.peerList={},n.monitorInterval=null,n.oldTransactions={},n.requestList={},n.startMonitoring=Object(w.a)(y.a.mark(function e(){var t;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return clearInterval(n.monitorInterval),t={video:!0,audio:!0},e.next=4,Q(t);case 4:n.stream=e.sent,n.currentTimestamp=F();try{n.broadcastRequest(),n.monitorInterval=setInterval(n.monitorRequest,n.interval)}catch(a){clearInterval(n.monitorInterval),console.error(a)}case 7:case"end":return e.stop()}},e)})),n.sendDonationOffer=function(e){var t={type:n.type.DONATE_OFFER};n.sendMessage(e,JSON.stringify(t))},n.broadcastRequest=function(){var e={id:n.myId,username:n.myUsername,type:n.type.REQUEST};n.broadcastTransaction(e)},n.broadcastTransaction=function(e){var t=Z(e,n.roomId);n.iota.prepareTransfers(n.seed,t).then(function(){var e=Object(w.a)(y.a.mark(function e(t){return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.iota.sendTrytes(t,L,n.minWeight);case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())},n.monitorRequest=Object(w.a)(y.a.mark(function e(){var t,a,r;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.getNewTransactions();case 3:t=e.sent,a=n.getBundles(t),r=n.getSignals(a),console.log("New signals from Tangle:"),console.log(r),n.processSignals(r),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.error(e.t0);case 14:case"end":return e.stop()}},e,null,[[0,11]])})),n.getNewTransactions=Object(w.a)(y.a.mark(function e(){var t,a;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={tags:[n.roomId]},e.next=3,n.iota.findTransactionObjects(t);case 3:return a=e.sent,e.abrupt("return",a.filter(function(e){var t=e.timestamp,a=e.bundle;return t>n.currentTimestamp&&!n.oldTransactions[a]}));case 5:case"end":return e.stop()}},e)})),n.getBundles=function(e){var t={},a=[],r=!0,o=!1,c=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done);r=!0){var l=i.value,u=l.bundle;n.oldTransactions[u]=!0,t[u]||(t[u]=[]),t[u].push(l)}}catch(m){o=!0,c=m}finally{try{r||null==s.return||s.return()}finally{if(o)throw c}}for(var d in t)a.push(t[d]);return a.map(function(e){return e.sort(function(e,t){return e.currentIndex>t.currentIndex?1:-1})})},n.getSignals=function(e){return e.reduce(function(e,t){var a=z(t),r=a.type,o=a.id;return r===n.type.REQUEST&&o===n.myId||e.push(a),e},[])},n.startOffering=function(e){var t=e.id,a=e.username;if(!n.peerList[t]){var r=Object(We.a)(n),o=r.stream,c=r.config,i=n.createPeer({initiator:!0,stream:o,id:t,config:c});n.attachEventHandlers(i,t,a)}},n.startAnswering=function(e,t,a,r){if(e===n.myId){if(!n.peerList[t]){console.log("started connector");var o=Object(We.a)(n),c=o.config,i=o.stream,s=n.createPeer({initiator:!1,stream:i,id:t,config:c});n.attachEventHandlers(s,t,a)}var l=!0,u=!1,d=void 0;try{for(var m,b=r[Symbol.iterator]();!(l=(m=b.next()).done);l=!0){var p=m.value;n.peerList[t].signal(p)}}catch(f){u=!0,d=f}finally{try{l||null==b.return||b.return()}finally{if(u)throw d}}}},n.processSignals=function(e){var t=!0,a=!1,r=void 0;try{for(var o,c=e[Symbol.iterator]();!(t=(o=c.next()).done);t=!0){var i=o.value,s=i.type,l=i.id,u=i.peerId,d=i.username,m=i.data;switch(s){case n.type.REQUEST:n.startOffering(i);break;case n.type.WEBRTCSIGNAL:n.startAnswering(l,u,d,m);break;default:console.log("Unknown signal")}}}catch(b){a=!0,r=b}finally{try{t||null==c.return||c.return()}finally{if(a)throw r}}},n.createPeer=function(e){var t=e.initiator,a=e.stream,r=e.id,o=e.config,c=new Fe.a({initiator:t,stream:a,config:o,trickle:!0});return n.peerList[r]=c},n.attachEventHandlers=function(e,t,r){var o=Object(Le.debounce)(function(e){var t=e.signalData,a=e.signalQueue;n.broadcastTransaction(t),a.length=0},1e3),c={id:t,username:r},i=[];e.on("signal",function(e){i.push(e);var r={id:t,username:n.myUsername,type:n.type.WEBRTCSIGNAL,peerId:n.myId,data:[].concat(i)};o({signalData:r,signalQueue:i}),n.emit("signal",Object(a.a)({},c,{signalQueue:i}))}),e.on("data",function(){var t=Object(w.a)(y.a.mark(function t(r){var o,i,s,l,u,d,m,b,p;return y.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:o=r.toString(),o=JSON.parse(o),t.t0=o.type,t.next=t.t0===n.type.CHAT_MESSAGE?5:t.t0===n.type.DONATE_OFFER?7:t.t0===n.type.DONATE_ACCEPT?14:18;break;case 5:return n.emit("chatmessage",Object(a.a)({},c,{message:o})),t.abrupt("break",18);case 7:return t.next=9,n.account.generateCDA({timeoutAt:Date.now()+864e5,expectedAmount:1});case 9:return i=t.sent,s=Object(Ze.serializeCDAMagnet)(i),l={type:n.type.DONATE_ACCEPT,data:s},e.send(JSON.stringify(l)),t.abrupt("break",18);case 14:return u=Object(Ze.parseCDAMagnet)(o.data),d=u.address,m=u.timeoutAt,b=u.multiUse,p=u.expectedAmount,n.account.sendToCDA({address:d,timeoutAt:m,multiUse:b,expectedAmount:p,value:1}).catch(function(e){console.log(e)}),t.abrupt("break",18);case 18:n.emit("data",Object(a.a)({},c,{data:r.toString()}));case 19:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),e.on("stream",function(e){n.emit("stream",Object(a.a)({},c,{srcObject:e}))}),e.on("track",function(e,t){console.log("track"),n.emit("track",Object(a.a)({},c,{track:e,stream:t}))}),e.on("connect",function(){n.emit("connect",c)}),e.on("close",function(){console.log("close"),n.emit("close",c),e.destroy(),delete n.peerList[t]}),e.on("error",function(e){console.log("error")})},n.stopStreaming=function(){if(n.stream){var e=n.stream.getTracks(),t=!0,a=!1,r=void 0;try{for(var o,c=e[Symbol.iterator]();!(t=(o=c.next()).done);t=!0){o.value.stop()}}catch(i){a=!0,r=i}finally{try{t||null==c.return||c.return()}finally{if(a)throw r}}}},n.stopMonitoring=function(){clearInterval(n.monitorInterval)},n.endMonitoring=function(){n.stopStreaming(),clearInterval(n.monitorInterval);for(var e=0,t=Object.keys(n.peerList);e<t.length;e++){var a=t[e];n.peerList[a].destroy()}n.peerList={}},n.seed=r,n.myUsername=o,n.myId=Qe()(),n.roomId=c,n.minWeight=i,n.interval=l,n.config={iceServers:s},n.iota=Object(ze.composeAPI)({provider:u}),n.account=d,n}return Object(_e.a)(t,e),Object(Pe.a)(t,[{key:"sendMessage",value:function(e,t){var n=this.peerList[e];n&&n.connected&&n.send(t)}},{key:"broadcastMessage",value:function(e){for(var t=0,n=Object.keys(this.peerList);t<n.length;t++){var a=n[t];this.peerList[a].connected&&this.peerList[a].send(e)}}}]),t}(Ve.a);function Xe(e){var t=e.username,n=(e.id,e.srcObject),a=e.sendDonationOffer;return X.a.createElement("div",{className:"peer"},X.a.createElement("video",{className:"peer__video",autoPlay:!0,ref:function(e){return function(e){if(e)try{e.srcObject=n}catch(t){console.log("error")}}(e)},width:300,height:300},X.a.createElement("track",{kind:"captions",srcLang:"en",label:t})),X.a.createElement("div",{className:"peer__username"},"User: ".concat(t)),X.a.createElement("button",{type:"button",className:"peer__donate",onClick:a},"Send 1 iota token"))}function Ye(e){var t=e.match.params.roomId,n=e.history,c=Object(r.useGlobal)("username"),i=Object(m.a)(c,1)[0],s=Object(r.useGlobal)("myId"),l=Object(m.a)(s,1)[0],u=Object(r.useGlobal)("tangleNet"),d=Object(m.a)(u,1)[0],b=Object(r.useGlobal)("iceServers"),p=Object(m.a)(b,1)[0],f=Object(r.useGlobal)("seed"),g=Object(m.a)(f,1)[0],v=Object(r.useGlobal)("myAccount"),O=Object(m.a)(v,1)[0],h=Object(r.useState)([]),j=Object(m.a)(h,2),E=(j[0],j[1]),S=Object(r.useState)([]),k=Object(m.a)(S,2),C=k[0],A=k[1],x=Object(r.useState)(0),I=Object(m.a)(x,2),T=I[0],N=I[1],D=Object(r.useState)(null),M=Object(m.a)(D,2),G=M[0],L=M[1],P=Object(r.useState)("myBalance"),U=Object(m.a)(P,2),B=U[0],W=U[1],_={username:i,seed:g,myId:l,roomId:t,minWeight:d.MWM,iceServers:p,interval:R,provider:d.URL,account:O};return Object(r.useEffect)(function(){var e=Object(Me.createAccount)({seed:g,provider:d.URL,persistencePath:"".concat(i),persistenceAdapter:Ge.createPersistenceAdapter});e.getTotalBalance().then(function(e){return W(e)}),e.on("includedDeposit",Object(Le.debounce)(function(){var t=Object(w.a)(y.a.mark(function t(n){var a;return y.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n.address,n.bundle,console.log("Incoming payment confirmed"),t.next=4,e.getTotalBalance();case 4:a=t.sent,W(a);case 6:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),1e3),e.on("includedWithdrawal",Object(Le.debounce)(function(){var t=Object(w.a)(y.a.mark(function t(n){var a;return y.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n.address,n.bundle,console.log("Outgoing payment confirmed"),t.next=4,e.getTotalBalance();case 4:a=t.sent,W(a);case 6:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),1e3),e.startAttaching({depth:3,minWeightMagnitude:9,delay:5e3,maxDepth:6});var t=new Ke(Object(a.a)({},_,{account:e}));return L(t),t.startMonitoring(),t.on("connect",function(e){E(function(t){return[].concat(Object(De.a)(t),[e])}),N(function(e){return e+1})}),t.on("stream",function(e){A(function(t){return[].concat(Object(De.a)(t),[e])})}),t.on("close",function(e){A(function(t){return t.filter(function(t){return t.id!==e.id})}),N(function(e){return e-1})}),window.onbeforeunload=function(){t.endMonitoring()},function(){window.onbeforeunload=void 0,t.endMonitoring()}},[]),o.a.createElement("div",null,o.a.createElement("div",null,"My Balance: ".concat(B)),o.a.createElement("div",null,"Room ID: ".concat(t)),o.a.createElement("button",{type:"button",onClick:function(){return n.push("/")}},"Return home"),o.a.createElement("button",{type:"button",onClick:function(){return G.stopMonitoring()}},"Stop monitoring"),o.a.createElement("button",{type:"button",onClick:function(){return G.endMonitoring()}},"End Peer connection"),o.a.createElement("button",{type:"button",onClick:function(){return G.startMonitoring()}},"Start Monitoring"),o.a.createElement("div",null,T),C.map(function(e){return o.a.createElement(Xe,{id:e.id,key:e.id,username:e.username,srcObject:e.srcObject,sendDonationOffer:function(){return t=e.id,console.log(O),console.log("chatroom send donation"),void G.sendDonationOffer(t);var t}})}))}window.genTryte=J;var $e=n(477),et=Object(j.a)(function(e){return{"@global":{body:{backgroundColor:e.palette.common.white}},paper:{marginTop:e.spacing(4),marginBottom:e.spacing(4),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:V},form:{width:"100%",marginTop:e.spacing(3)},submit:{margin:e.spacing(3,0,2),backgroundColor:V},seedGen:{margin:e.spacing(2,0,0)}}});function tt(e){var t=e.history,n=Object(r.useContext)(Ie),a=Object(r.useState)(""),c=Object(m.a)(a,2),i=c[0],s=c[1],l=Object(r.useState)(""),u=Object(m.a)(l,2),d=u[0],v=u[1],j=Object(r.useState)(""),E=Object(m.a)(j,2),y=E[0],w=E[1],S=Object(r.useState)(!1),k=Object(m.a)(S,2),C=k[0],A=k[1],x=Object(r.useState)("info"),I=Object(m.a)(x,2),T=I[0],N=I[1],D=Object(r.useState)("Info"),G=Object(m.a)(D,2),L=G[0],R=G[1],P=Object(r.useState)(!1),U=Object(m.a)(P,2),B=U[0],W=U[1];function _(e,t){R(e),N(t),W(!0)}var H=et();return o.a.createElement(b.a,{component:"main",maxWidth:"sm"},o.a.createElement("div",{className:H.paper},o.a.createElement(p.a,{className:H.avatar},o.a.createElement(O.a,null)),o.a.createElement(h.a,{component:"h1",variant:"h5"},"Sign up"),o.a.createElement("form",{className:H.form,noValidate:!0},o.a.createElement(ce,{label:"Username",value:i,setValue:s}),o.a.createElement(oe,{setShowPassword:A,password:d,setPassword:v,showPassword:C}),o.a.createElement(f.a,{type:"button",variant:"contained",color:"secondary",className:H.seedGen,onClick:function(){w(J(M))}},"Generate Seed"),o.a.createElement(ce,{label:"Seed",value:y,setValue:w}),o.a.createElement(f.a,{type:"button",fullWidth:!0,variant:"contained",color:"primary",className:H.submit,onClick:function(){var e=n.getCollection("users"),a=e.findOne({username:i}),r=e.findOne({seed:y});if(!i||!y||!d)return _("Please enter all required field","error");if(a)return _("Username existed","error");if(r)return _("Account for seed existed","error");if(!Object($e.isTrytes)(y,M))return _("Invalid Seed","error");var o=q(i,d),c=Qe()();e.insert({username:i,userHash:o,seed:y,myId:c}),_("Account created","success"),t.push("/login")}},"Sign Up"),o.a.createElement(g.a,{container:!0,justify:"flex-end"},o.a.createElement(g.a,{item:!0},o.a.createElement(f.a,{onClick:function(){t.push("/login")}},"Already have an account? Log in"))))),o.a.createElement(Ae,{variant:T,message:L,open:B,onClose:function(){return W(!1)},autoHideDuration:2e3}))}var nt=function(){};function at(e){var t=e.history,n=Object(r.useGlobal)("seed"),a=Object(m.a)(n,1)[0],c=Object(r.useGlobal)("provider"),i=Object(m.a)(c,1)[0],s=Object(r.useGlobal)("username"),l=Object(m.a)(s,1)[0],u=Object(r.useGlobal)("loggedIn"),d=Object(m.a)(u,2)[1],b=Object(r.useState)(""),p=Object(m.a)(b,2),f=p[0],g=p[1],v=Object(r.useState)("myBalance"),O=Object(m.a)(v,2),h=O[0],j=O[1],E=Object(r.useState)("faucetAddr"),S=Object(m.a)(E,2),k=S[0],C=S[1];return Object(r.useEffect)(function(){Object(ze.composeAPI)({provider:i}).getAccountData(a).then(function(e){return console.log(e)});var e=Object(Me.createAccount)({seed:a,provider:i,persistencePath:"".concat(l),persistenceAdapter:Ge.createPersistenceAdapter});return e.getAvailableBalance().then(function(e){return j(e)}),e.startAttaching({depth:3,minWeightMagnitude:9,delay:5e3,maxDepth:6}),e.on("includedDeposit",Object(Le.debounce)(function(){var t=Object(w.a)(y.a.mark(function t(n){var a;return y.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n.address,n.bundle,console.log("Incoming payment confirmed"),t.next=4,e.getTotalBalance();case 4:a=t.sent,j(a);case 6:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),1e3),e.on("includedWithdrawal",Object(Le.debounce)(function(){var t=Object(w.a)(y.a.mark(function t(n){var a;return y.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n.address,n.bundle,console.log("Outgoing payment confirmed"),t.next=4,e.getTotalBalance();case 4:a=t.sent,j(a);case 6:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),1e3),e.generateCDA({timeoutAt:Date.now()+864e5}).then(function(e){return C(e.address.substr(0,M))}),nt(e),function(){e.stopAttaching(),e.removeAllListeners()}},[]),o.a.createElement("div",null,o.a.createElement("div",null,"My seed: ".concat(a)),o.a.createElement("div",null,"My balance: ".concat(h)),o.a.createElement("div",null,"Use this address to request for devnet tokens: ".concat(k)),o.a.createElement("div",null,o.a.createElement("a",{target:"_blank",href:"https://faucet.devnet.iota.org",rel:"noopener noreferrer"},"Open devnet faucet link in new tab")),o.a.createElement("button",{type:"button",onClick:function(){var e=J(G);t.push("chatroom/".concat(e))}},"Create chatroom"),o.a.createElement("button",{type:"button",onClick:function(){Object($e.isTrytes)(f,G)&&t.push("chatroom/".concat(f))}},"Join chatroom"),o.a.createElement("input",{type:"text",onChange:function(e){return g(e.target.value)},value:f}),o.a.createElement("button",{type:"button",onClick:function(){localStorage.removeItem("userData"),d(!1),Object(r.setGlobal)(xe),console.log(Object(r.getGlobal)())}},"Logout"))}var rt=n(674),ot={backgroundColor:"#607D8B",borderRadius:"12%",height:"250px",width:"250px",boxShadow:"2px 2px 10px 0px rgba(0,0,0,0.59)"},ct=function(){return X.a.createElement(rt.TrinityRingsSpinner,{color:"#33B3A6",size:125,style:ot})},it=function(e){return Object(d.g)(function(t){var n=Object(r.useGlobal)("loggedIn");return Object(m.a)(n,1)[0]?o.a.createElement(d.a,{to:U}):o.a.createElement(e,t)})},st=function(e){return Object(d.g)(function(t){var n=Object(r.useGlobal)("loggedIn");return Object(m.a)(n,1)[0]?o.a.createElement(e,t):o.a.createElement(d.a,{to:W})})},lt=function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(u.Helmet,null,o.a.createElement("title",null,"IOTA - WebRTC"),o.a.createElement("meta",{name:"description",content:"A decentralized chat and video call application"}),o.a.createElement("meta",{charSet:"utf-8"})),o.a.createElement(d.d,null,o.a.createElement(d.b,{exact:!0,path:U,component:st(at)}),o.a.createElement(d.b,{exact:!0,path:W,component:it(Ne)}),o.a.createElement(d.b,{exact:!0,path:B,component:it(tt)}),o.a.createElement(d.b,{exact:!0,path:_,component:st(Ye)}),o.a.createElement(d.b,{exact:!0,path:H,component:ct}),o.a.createElement(d.a,{to:U})))},ut=n(678),dt=n.n(ut),mt=n(521),bt=n.n(mt),pt=localStorage.getItem("userData");if(pt)try{var ft=JSON.parse(pt);Object(r.setGlobal)(Object(a.a)({},xe,ft,{loggedIn:!0})),console.log(Object(r.getGlobal)())}catch(ht){localStorage.removeItem("userData"),Object(r.setGlobal)(xe)}else Object(r.setGlobal)(xe);var gt=new bt.a,vt=new dt.a("test.db",{adapter:gt,autoload:!0,autosave:!0,autosaveInterval:4e3,autoloadCallback:function(){console.log("Database loaded"),vt.getCollection("users")||vt.addCollection("users")}});window.iota=ze;var Ot=document.getElementById("root");console.log("render called"),i.a.render(o.a.createElement(l.a,null,o.a.createElement(s.a,null),o.a.createElement(Ie.Provider,{value:vt},o.a.createElement(lt,null))),Ot)},696:function(e,t,n){e.exports=n(1012)},719:function(e,t,n){},753:function(e,t){},755:function(e,t){},878:function(e,t){},880:function(e,t){}},[[696,1,2]]]);
//# sourceMappingURL=main.cbfd977d.chunk.js.map